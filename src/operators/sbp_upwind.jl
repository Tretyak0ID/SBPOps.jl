export sbp_uw2, sbp_uw4, sbp_uw6

function sbp_uw2(N::Int, h::Union{Float64, Float32, Int64, Int32})
    H, Hi = norm21_uw(N, h)

    Qp = spdiagm(0 => -3/2*ones(N), 1 => 2*ones(N-1), 2 => -1/2*ones(N-2))
    Qp_coefs = [-1/4 5/4; -1/4 -5/4]
    Qp[1:2,1:2]     = Qp_coefs
    Qp[N-1:N,N-1:N] = rotr90(Qp_coefs, 2)'
    Qm = -Qp'

    e1 = spzeros(N,1)
    e1[1] = 1
    eN = spzeros(N,1)
    eN[N] = 1

    Dp = Hi * (Qp - 1/2 * (e1 * e1') + 1/2 * (eN * eN'))
    Dm = Hi * (Qm - 1/2 * (e1 * e1') + 1/2 * (eN * eN'))

    return H, Dp, Dm
end

function sbp_uw4(N::Int, h::Union{Float64, Float32, Int64, Int32})
    H, Hi = norm42_uw(N, h)

    Qp = spdiagm(-1 => -1/4*ones(N-1), 0 => -5/6*ones(N), 1 => 3/2*ones(N-1), 2 => -1/2*ones(N-2), 3 => 1/12*ones(N-3))
    Qp_coefs = [-1/48 205/288 -29/144 1/96;
                -169/288 -11/48 33/32 -43/144;
                11/144 -13/32 -29/48 389/288;
                1/32 -11/144 -65/288 -13/16]
    Qp[1:4,1:4]     = Qp_coefs
    Qp[N-3:N,N-3:N] = rotr90(Qp_coefs, 2)'
    Qm = -Qp'

    e1 = spzeros(N,1)
    e1[1] = 1
    eN = spzeros(N,1)
    eN[N] = 1

    Dp = Hi * (Qp - 1/2 * (e1 * e1') + 1/2 * (eN * eN'))
    Dm = Hi * (Qm - 1/2 * (e1 * e1') + 1/2 * (eN * eN'))

    return H, Dp, Dm
end

function sbp_uw6(N::Int, h::Union{Float64, Float32, Int64, Int32})
    H, Hi = norm63_uw(N, h)

    Qp = spdiagm(-2 => 1/30*ones(N-2), -1 => -2/5*ones(N-1), 0 => -7/12*ones(N), 1 => 4/3*ones(N-1), 2 => -1/2*ones(N-2), 3 => 2/15*ones(N-3), 4 => -1/60*ones(N-4))
    Qp_coefs = [-265/128688 1146190567/1737288000 -1596619/18384000 -55265831/579096000 26269819/3474576000 2464501/144774000;
    -1116490567/1737288000 -8839/214480 190538869/347457600 102705469/694915200 413741/9651600 -191689861/3474576000;
    1096619/18384000 -135385429/347457600 -61067/321720 45137333/57909600 -253641811/694915200 70665929/579096000;
    66965831/579096000 -208765789/694915200 -17623253/57909600 -18269/45960 410905829/347457600 -477953317/1158192000;
    -49219819/3474576000 293299/9651600 26422771/694915200 -141938309/347457600 -346583/643440 2217185207/1737288000;
    -2374501/144774000 142906261/3474576000 -3137129/579096000 -29884283/1158192000 -630168407/1737288000 -3559/6128]
    Qp[1:6,1:6]     = Qp_coefs
    Qp[N-5:N,N-5:N] = rotr90(Qp_coefs, 2)'
    Qm = -Qp'

    e1 = spzeros(N,1)
    e1[1] = 1
    eN = spzeros(N,1)
    eN[N] = 1

    Dp = Hi * (Qp - 1/2 * (e1 * e1') + 1/2 * (eN * eN'))
    Dm = Hi * (Qm - 1/2 * (e1 * e1') + 1/2 * (eN * eN'))

    return H, Dp, Dm
end