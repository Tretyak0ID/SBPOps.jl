export sbp21, sbp42, sbp63

function sbp21(N::Int, h::Union{Float64, Float32, Int64, Int32})
    H, Hi = norm21(N, h)

    Q = spdiagm(-1 => -1/2*ones(N-1), 1 => 1/2*ones(N-1))
    Q[1, 1:2]  = [-1/2 1/2]
    Q[N,N-1:N] = [-1/2 1/2]

    return H, Hi * Q
end

function sbp42(N::Int, h::Union{Float64, Float32, Int64, Int32})
    H, Hi = norm42(N, h)

    Q_coefs = [-1/2 59/96 -1/12 -3/96 0 0;
               -59/96 0 59/96 0 0 0;
               1/12 -59/96 0 59/96 -1/12 0;
               3/96 0 -59/96 0 32/48 -1/12]
    Q = spdiagm(-2 => 1/12*ones(N-2), -1 => -2/3*ones(N-1), 1 => 2/3*ones(N-1), 2 => -1/12*ones(N-2))
    Q[1:4, 1:6]     = Q_coefs
    Q[N-3:N, N-5:N] = -rotr90(Q_coefs, 2)

    return H, Hi * Q
end

function sbp63(N::Int, h::Union{Float64, Float32, Int64, Int32})
    H, Hi = norm63(N, h)

    fp = 5591070156686698065364559/7931626489314500743872000 #approximation order opt parameter
    Q_coefs = [-1/2 (-953/16200+fp) (715489/259200-4*fp) (-62639/14400+6*fp) (147127/51840-4*fp) (-89387/129600+fp) 0 0 0;
               (953/16200-fp) 0 (57139/8640+10*fp) (745733/51840-20*fp) (-18343/1728+15*fp) (240569/86400-4*fp) 0 0 0;
               (-715489/259200+4*fp) (-57139/8640-10*fp) 0 (176839/12960+20*fp) (242111/17280-20*fp) (-182261/43200+6*fp) 0 0 0;
               (62639/14400-6*fp) (-745733/51840+20*fp) (-176839/12960-20*fp) 0 (-165041/25920+10*fp) (710473/259200-4*fp) 1/60 0 0;
               (-147127/51840+4*fp) (18343/1728-15*fp) (-242111/17280+20*fp) (165041/25920-10*fp) 0 fp -3/20 1/60 0;
               (89387/129600-fp) (-240569/86400+4*fp) (182261/43200-6*fp) (-710473/259200+4*fp) fp 0 3/4 -3/20 1/60]
    Q = spdiagm(-3 => -1/6*ones(N-3), -2 => 3/2*ones(N-2), -1 => -3/4*ones(N-1), 1 => 3/4*ones(N-1), 2 => -3/2*ones(N-2), 3 => 1/6*ones(N-3))
    Q[1:6, 1:9]     = Q_coefs
    Q[N-5:N, N-8:N] = -rotr90(Q_coefs, 2)

    return H, Hi * Q
end